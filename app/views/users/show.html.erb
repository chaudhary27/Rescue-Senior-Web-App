<!-- <meta HTTP-EQUIV="REFRESH" content="10";> -->
<script type="text/JavaScript">

// function timedRefresh(timeoutPeriod) {
//   setTimeout("location.reload(true);",timeoutPeriod);
//
// }
//
// window.onload = timedRefresh(10000);

</script>

<div class="container">
  <div class="row">
    <div class="col-md-3 text-center">
      <%= image_tag @user.profile.avatar.url, class: 'avatar-show-img' %>
    </div>
    
    <div class="col-md-6">
      <h1><%= @user.profile.first_name %>  <%= @user.profile.last_name %></h1> <br>
      <h3><span class="health-band-icon"><%= health_band_icon %></span> Tracking Health via <%= @user.profile.health_band %> <%= @ref.child(:device).val() %></h3>
      <h3><span> <i class="fa fa-battery-full" aria-hidden="true"></i></span> Battery level: <%= @ref.child(:device_battery).val() %></h3>
      <h4><a href="http://localhost:3000/users/1"><span class="label label-primary">Refresh Data</span></a></h4>
      <h4><a href="http://localhost:3001" target="_blank"><span class="label label-danger">Authenticate Fitbit</span></a></h4> <br>
      <div class="well profile-block profile-contact-info">
        <h3 class="text-center">Contact Information</h3> <br>
        <h4>Phone Number: <%= @user.profile.phone_number %> </h4>
        <h4>Age: <%= @user.profile.age %></h4>
        <h4>Height: <%= @user.profile.height_feet %>' <%= @user.profile.height_inches %>''</h4>
        <h4>Contact Email: <%= @user.profile.contact_email %></h4>
        <hr>
        <h3 class="text-center">Daily Metrics</h3>
        <h4>Step Count: <%= @ref.child(:steps_count).val() %></h4>
        <h4>Resting Heart Rate: <%= @ref.child(:resting_heart_rate).val() %> BPM</h4>
        <h4>Inactive: <%= @ref.child(:inactive_minutes).val() %> mins</h4>
        
      </div>
    </div>
    
    <!--  <p><%= @zone.child(:"0", :name).val %></p>
    <p><%= @zone.child(:"1", :name).val %></p> -->
    <div class="col-md-6 col-md-offset-3">
      <div class="well profile-block profile-health-info-1">
        <h3 class="text-center">Realtime Health Data</h3><br>
        <h4>Zone: <%= @zone.child(:"0", :name).val %></h4>
        <h4>BPM Range: <%= @zone.child(:"0", :min).val %> BPM - <%= @zone.child(:"0", :max).val %> BPM</h4>
        <h4>Time in range: <%= @zone.child(:"0", :minutes).val %> mins</h4>
        <h4>Calories count: <%= @zone.child(:"0", :calories_out).val %></h4>
      </div>
    </div>
    <div class="col-md-6 col-md-offset-3">
      <div class="well profile-block profile-health-info-2">
        <!-- <h3 class="text-center">Realtime Health Data</h3><br> -->
        <h4>Zone: <%= @zone.child(:"1", :name).val %></h4>
        <h4>BPM Range: <%= @zone.child(:"1", :min).val %> BPM - <%= @zone.child(:"1", :max).val %> BPM</h4>
        <h4>Time in range: <%= @zone.child(:"1", :minutes).val %> mins</h4>
        <h4>Calories count: <%= @zone.child(:"1", :calories_out).val %></h4>
      </div>
    </div>
    <div class="col-md-6 col-md-offset-3">
      <div class="well profile-block profile-health-info-3">
        <!-- <h3 class="text-center">Realtime Health Data</h3><br> -->
        <h4>Zone: <%= @zone.child(:"2", :name).val %></h4>
        <h4>BPM Range: <%= @zone.child(:"2", :min).val %> BPM - <%= @zone.child(:"2", :max).val %> BPM</h4>
        <h4>Time in range: <%= @zone.child(:"2", :minutes).val %> mins</h4>
        <h4>Calories count: <%= @zone.child(:"2", :calories_out).val %></h4>
      </div>
    </div>
    <div class="col-md-6 col-md-offset-3">
      <div class="well profile-block profile-health-info-4">
        <!-- <h3 class="text-center">Realtime Health Data</h3><br> -->
        <h4>Zone: <%= @zone.child(:"3", :name).val %></h4>
        <h4>BPM Range: <%= @zone.child(:"3", :min).val %> BPM - <%= @zone.child(:"3", :max).val %> BPM</h4>
        <h4>Time in range: <%= @zone.child(:"3", :minutes).val %> mins</h4>
        <h4>Calories count: <%= @zone.child(:"3", :calories_out).val %></h4>
      </div>
    </div>
    
    <div class="col-md-6 col-md-offset-3">
      <div class="well profile-block profile-location-info">
        <h3 class="text-center">Realtime Indoor Location</h3><br>
        <% if (@beacon.child(:"0", :major).val == 16613 && @beacon.child(:"0", :minor).val == 25364) %>
        <h4>Indoor Location: <%= @beacon_location_1 %></h4>
        <h4>Address: <%= @beacon_location_1_addrss %></h4>
        <h4><a href="https://www.google.com/maps/place/The+City+College+of+New+York:+North+Academic+Center/@40.8196351,-73.9527095,17z/data=!3m1!4b1!4m5!3m4!1s0x89c2f66570808709:0x9bad2a6bc19dfe6f!8m2!3d40.8196311!4d-73.9505155" target="_blank"><span class="label label-primary">Open Map</span></a></h4>
        
        <% elsif (@beacon.child(:"0", :major).val == 28803 && @beacon.child(:"0", :minor).val == 64459) %>
        <h4>Indoor Location: <%= @beacon_location_2 %></h4>
        <h4>Address: <%= @beacon_location_2_addrss %></h4>
        <h4><a href="https://www.google.com/maps/place/The+City+College+of+New+York:+North+Academic+Center/@40.8196351,-73.9527095,17z/data=!3m1!4b1!4m5!3m4!1s0x89c2f66570808709:0x9bad2a6bc19dfe6f!8m2!3d40.8196311!4d-73.9505155" target="_blank"><span class="label label-primary">Open Map</span></a></h4>
        <% end %>
        
        <h4>Proximity: <%= @beacon.child(:"0", :beacon, :proximity).val %></h4>
        <h4>Beacon rssi: <%= @beacon.child(:"0", :rssi).val %></h4>
        <h4>Beacon Tx: <%= @beacon.child(:"0", :beacon, :tx).val %></h4>
        <h4>Beacon Accuracy: <%= @beacon.child(:"0", :beacon, :accuracy).val %></h4>
        <h4>Beacon UUID: <%= @beacon.child(:"0", :beacon, :uuid).val %></h4>
        <h4>Beacon Manufacturer: Estimote</h4>
      </div>
    </div>
    
  </div>
</div>
